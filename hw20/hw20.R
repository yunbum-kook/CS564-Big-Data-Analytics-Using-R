##### HW20 #####
################
# Library
library(hflights)
library(data.table)
library(tseries)

# Problem 1
# (1)
Rate <- c(7.8,8.3,8.7,9.0,9.4,9.5,9.5,9.6,9.8,10.0,9.9,9.9,
          9.8,9.8,9.9,9.9,9.6,9.4,9.4,9.5,9.5,9.4,9.8,9.3,
          9.1,9.0,9.0,9.1,9.0,9.1,9.0,9.0,9.0,8.8,8.6,8.5,
          8.3,8.3,8.2,8.2,8.2,8.2,8.2,8.1,7.8,7.8,7.7,7.9,
          8.0,7.7,7.5,7.6,7.5,7.5,7.3,7.2,7.2,7.2,6.9,6.7,
          6.6,6.7,6.7,6.2,6.3,6.1,6.2,6.1,5.9,5.7,5.8,5.6,
          5.7,5.5,5.4,5.4,5.6,5.3,5.2,5.1,5.0,5.0,5.1,5.0,
          4.9,4.9,5.0,5.0,4.8,4.9,4.8,4.9,5.0,4.9,4.7,4.7,
          4.7,4.7,4.4,4.4,4.4,4.3,4.3,4.4,4.2,4.1,4.2,4.1,
          4.1,4.1,4.0,3.9,3.8,4.0,3.9,3.8,3.7,3.8,3.7,3.9)

mytsd = ts(Rate, start=c(2009, 1), frequency=12)

# (2)
plot(mytsd)

# (3)
acf(mytsd) # Non stationary data
kpss.test(mytsd) # Not stationary

# (4)
dec = decompose(mytsd)
plot(dec$random)

# (5)
m = HoltWinters(mytsd)
p = predict(m, 12, level=c(90,95))
plot(m, p)
